<div class="row">
    <div class="col-10 offset-1">
        <div class="mb-3">
            <label for="txtName" class="form-label">Name</label>
            <input type="email" class="form-control" id="txtName" placeholder="Enter name here..." value="{{ transaction_category.name|default:'' }}">
        </div>
        <div class="mb-3">
            <label for="txtDescription" class="form-label">Description</label>
            <textarea class="form-control" id="txtDescription" rows="3" placeholder="Enter description here...">{{ transaction_category.description|default:"" }}</textarea>
        </div>
    </div>
    <div class="d-flex justify-content-center gap-2">
        <button type="submit" class="btn btn-success" value="{{ transaction_category.id }}" id="btnSaveCategory">Save</button>
        <button type="submit" class="btn btn-danger" value="{{ transaction_category.id }}" id="btnDeleteCategory">Delete</button>
    </div>
</div>

<script>
  // Save Transaction Category
  $('#btnSaveCategory').click(function(e) {

    e.preventDefault();  // Prevent default form submission behavior

    // Check if Name field has been filled out before saving
    if ($("#txtName").val() == "") {
      alert("Please enter a name first.");
      return false;
    }

    $.ajax({  // do a hidden postback to the url(view) below
      type: 'POST',
      url: '{% url 'finance:save_transaction_category' %}',  //which URL mapping to redirect to
      data: {
        transaction_category_id: $('#btnSaveCategory').val(),  // get current value set on the button
        transaction_category_name: $("#txtName").val(),
        transaction_category_description: $("#txtDescription").val(),
        csrfmiddlewaretoken: '{{ csrf_token }}',
        action: 'post'
      },
      success: function(json) {
        alert('Saved!');
        window.location.href = "{% url 'finance:edit_categories' %}?selected_transaction_category=" + json.transaction_category_id;  // redirect after save
      },
      error: function(xhr, errmsg, err) {
        console.log(errmsg);
      }
    });
  })

  // Delete Transaction Category
  $('#btnDeleteCategory').click(function(e) {

    e.preventDefault();  // Prevent default form submission behavior

    if (!confirm('Are you sure you want to delete this transaction category?')) {
      return;  // Exit if user cancels
    }

    $.ajax({  // do a hidden postback to the url(view) below
      type: 'POST',
      url: '{% url 'finance:delete_transaction_category' %}',  //which URL mapping to redirect to
      data: {
        transaction_category_id: $(this).val(),  // get value of button that triggered the event
        csrfmiddlewaretoken: '{{ csrf_token }}',
        action: 'post'
      },
      success: function(json) {
        alert('Deleted!');
        window.location.href = "{% url 'finance:edit_categories' %}";  // redirect after delete
      },
      error: function(xhr, errmsg, err) {
        console.log(errmsg);
      }
    });
  })

</script>